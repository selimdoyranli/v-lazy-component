import{defineComponent as e,ref as t,reactive as r,watch as n,onMounted as s,onBeforeUnmount as o,openBlock as i,createBlock as d,resolveDynamicComponent as a,normalizeClass as l,withCtx as c,renderSlot as p,createCommentVNode as u}from"vue";var v=e({name:"LazyComponent",props:{wrapperTag:{type:String,required:!1,default:"div"},isIntersected:{type:Boolean,required:!1,default:!1},idle:{type:Boolean,required:!1,default:!1},rootMargin:{type:String,required:!1,default:"0px 0px 0px 0px"},threshold:{type:[Number,Array],required:!1,default:0}},setup(e,i){let{emit:d}=i;const a=t(null),l=r({wrapperTag:e.wrapperTag,isIntersected:e.isIntersected,idle:e.idle,rootMargin:e.rootMargin,threshold:e.threshold,observer:null});n((()=>e.isIntersected),(e=>{e&&(l.isIntersected=!0)})),n((()=>l.isIntersected),(e=>{e&&d("intersected",a.value)}));const c=()=>"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype&&"isIntersecting"in window.IntersectionObserverEntry.prototype,p=e=>{l.isIntersected=e.some((e=>e.intersectionRatio>0)),l.isIntersected&&u()},u=()=>{c()&&l.observer.unobserve(a.value)};return s((()=>{c()?l.isIntersected||l.idle||(()=>{const{rootMargin:e,threshold:t}=l,r={root:void 0,rootMargin:e,threshold:t};l.observer=new IntersectionObserver(p,r),l.observer.observe(a.value)})():l.isIntersected=!0,l.isIntersected&&d("intersected",a.value)})),o((()=>{l.isIntersected||l.idle||u()})),{rootRef:a,state:l}}});v.render=function(e,t,r,n,s,o){return i(),d(a(e.state.wrapperTag),{ref:"rootRef",class:l(["v-lazy-component",{"v-lazy-component--loading":!e.state.isIntersected,"v-lazy-component--loaded":e.state.isIntersected}]),style:{minWidth:"1px",minHeight:"1px"}},{default:c((()=>[e.state.isIntersected?p(e.$slots,"default",{key:0}):u("",!0),e.state.isIntersected?u("",!0):p(e.$slots,"placeholder",{key:1})])),_:3},8,["class"])};var I=(()=>{const e=v;return e.install=t=>{t.component("LazyComponent",e)},e})();export{I as default};
